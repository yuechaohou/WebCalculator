<!DOCTYPE html>
<html>
<head>
<link href="../bootstrap/css/bootstrap.css" rel="stylesheet">
<script type="text/javascript" src="jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
<link rel="stylesheet" type="text/css" href="style.css" />
<link rel="stylesheet" type="text/css" href="css/vicons-font.css" />
<meta http-equiv="Content-Type" content="text/html; charset=gb2312"><style type="text/css">

</style>
</head>
    
    
<body>
<div class="div1">
	<div class="div2">
	<img src="edge.png" height="100%" width="100%"/>    
	</div>
	<div class="div5">
		<div class = "text" id="display">
        	<div id="up" style="width:680px; overflow:hidden;text-overflow:ellipsis;" ></div>
        	<div id="down" style="width:680px; overflow:hidden;text-overflow:ellipsis;"></div>
		</div>
    <div class = "buttons">
		<span id = "lefts">
	  	 <span id="left"><button class="number button button--ujarak " id = "D" value="d">D</button></span>
		 <span id="left"><button class="number button button--ujarak  " id="E" value="e">E</button></span>
		 <span id="left"><button class="number button button--ujarak  " id="F" value="f">F </button></span>
		 </span>
		 <div class="rights">
		 <span id = "rights">
		 <span id="left"><button class="digit buttonp button--ujarak" value="decimal">D</button></span> 
		 <span id="left"><button class="back buttonl button--ujarak">&#8592 </button></span>
		 <span id="left"><button class="clear buttonp button--ujarak">C</button></span>
		 </span>
		 </div>
	
		<span id = "lefts">
	  	 <span id="left"><button class="number button button--ujarak  " id="A" value="a">A</button></span>
		 <span id="left"><button class="number button button--ujarak  " id="B" value="b">B</button></span>
		 <span id="left"><button class="number button button--ujarak  " id="C" value="c">C</button></span>
		 </span>
		 <div class = "rights">
		 <span id = "rights">
		<span id="left"><button class="digit buttond button--ujarak" value="binary">B</button></span>
		<span id="left"><button class="digit buttond button--ujarak" value="octual">O</button></span>
		<span id="left"><button class="digit buttond button--ujarak" value="hexa">H</button></span>
		</span>
		</div>
	
	<span id = "lefts">
		<span id="left"><button class="number button button--ujarak  " id="7" value="7">7</button></span>
		<span id="left"><button class="number button button--ujarak  " id="8" value="8">8</button></span> 
		<span id="left"><button class="number button button--ujarak  " id="9" value="9">9</button></span>
		</span>
		<div class = "rights">
		<span id = "rights">
		<span id="left"><button class="td buttonl button--ujarak" value="%5">&divide </button></span>
		<span id="left"><button class="left buttonl button--ujarak" value="#1">(</button></span> 
		<span id="left"><button class="right buttonl button--ujarak" value="#2">)</button></span>
		</span>
		</div>
	
	<span id = "lefts">
		<span id="left"><button class="number button button--ujarak  " id="4" value="4"> 4 </button></span>
		<span id="left"><button class="number button button--ujarak  " id="5" value="5"> 5 </button></span> 
		<span id="left"><button class="number button button--ujarak  " id="6" value="6"> 6 </button></span> 
		</span>
		<div class = "rights">
		<span id = "rights">
		<span id="left"><button class="td buttonl button--ujarak" value="%6"> % </button></span>
		<span id="left"><button class="sqrt buttonl button--ujarak" value="%7"> &#8730 </button></span>
		<span id="left"><button class="power buttonl button--ujarak" value="%8"> ^2 </button></span>
		</span>
		</div>
    
	<span id = "lefts">
		<span id="left"> <button class="number button button--ujarak  " id="1" value="1"> 1 </button></span>      
		<span id="left"><button class="number button button--ujarak  " id="2" value="2"> 2 </button></span> 
		<span id="left"><button class="number button button--ujarak  " id="3" value="3"> 3 </button></span>
		</span>
		<div class = "rights">
		<span id = "rights">
		<span id="left"><button class ="td buttonl button--ujarak" value="%3"> &times </button></span> 
		<span id="left"><button class="td buttonl button--ujarak" value="%4">/ </button></span>
		<span id="left"><button class= "equal button2 button--ujarak" value="=" height = "130px"> = </button></span>
		</span>
		</div>
	
    <div class="buttons1"> 
		<span id = "lefts">
		<span id="left1"><button class="number button3 button--ujarak" id="0" value="0"> 0 </button></span>
		<span id="left"><button class="dot button button--ujarak  " value="."> . </button></span>
		</span>
		<div class = "rights1">
		<span id = "rights">
		<span id="left"><button class="pm buttonl button--ujarak" value="%1"> + </button></span> 
		<span id="left"><button class="pm buttonl button--ujarak" value="%2"> - </button></span>
		</span>
		</div>
	</div>
		
</div>
</body>


<script>
	var result =0;
	var temp =0;
	var temp1 =0;
	var bracket=0;
	var sqrt=0;
	var output=[];
	var operator=[];
	var operation=[];
	var base = 10;
	$(function(){
		$("#A").hide();
		$("#B").hide();
		$("#C").hide();
		$("#D").hide();
		$("#E").hide();
		$("#F").hide();		
	});
	$(".digit").click(function(){
		if(this.value=="binary"){
		temp = $("#display #down").text();
		for(var i=0,l=output.length;i<l;i++)
		{
			if(output[i]>"0")
			{
				output[i]=transition(output[i],2);
			}
		}
		if(temp!="")
		{
			temp=transition(temp,2);
		}
		$("#2").hide();
		$("#3").hide();
		$("#4").hide();
		$("#5").hide();
		$("#6").hide();
		$("#7").hide();	
		$("#8").hide();
		$("#9").hide();
		$("#A").hide();
		$("#B").hide();
		$("#C").hide();
		$("#D").hide();
		$("#E").hide();
		$("#F").hide();	
		$("#display #up").text("");
		$("#display #down").text(temp);
		print();
		if(temp!=""&& temp1>0)
		{
			$("#display #up").append(temp);
		}
		base =2;
		}
		else if(this.value=="octual"){
		temp = $("#display #down").text();
		for(var i=0,l=output.length;i<l;i++)
		{
			if(output[i]>"0")
			{
				output[i]=transition(output[i],8);
			}
		}
		if(temp!="")
		{
		temp=transition(temp,8);
		}
		$("#2").show();
		$("#3").show();
		$("#4").show();
		$("#5").show();
		$("#6").show();
		$("#7").show();	
		$("#8").hide();
		$("#9").hide();
		$("#A").hide();
		$("#B").hide();
		$("#C").hide();
		$("#D").hide();
		$("#E").hide();
		$("#F").hide();	
		$("#display #up").text("");
		$("#display #down").text(temp);
		print();
		if(temp!=""&& temp1> 0)
		{
			$("#display #up").append(temp);
		}
		base =8;
		}
		else if(this.value=="decimal"){
		temp = $("#display #down").text();
		for(var i=0,l=output.length;i<l;i++)
		{
			if(output[i]>"0")
			{
				output[i]=transition(output[i],10);
			}
		}
		if(temp!="")
		{
			temp=transition(temp,10);
		}
		$("#2").show();
		$("#3").show();
		$("#4").show();
		$("#5").show();
		$("#6").show();
		$("#7").show();	
		$("#8").show();
		$("#9").show();
		$("#A").hide();
		$("#B").hide();
		$("#C").hide();
		$("#D").hide();
		$("#E").hide();
		$("#F").hide();	
		$("#display #up").text("");
		$("#display #down").text(temp);
		print();
		if(temp!=""&& temp1> 0)
		{
			$("#display #up").append(temp);
		}
		base =10;
		}
		else if(this.value="hexa"){
		temp = $("#display #down").text();
		for(var i=0,l=output.length;i<l;i++)
		{
			if(output[i]>"0")
			{
				output[i]=transition(output[i],16);
			}
		}
		if(temp!="")
		{
		temp=transition(temp,16);
		}
		$("#2").show();
		$("#3").show();
		$("#4").show();
		$("#5").show();
		$("#6").show();
		$("#7").show();	
		$("#8").show();
		$("#9").show();
		$("#A").show();
		$("#B").show();
		$("#C").show();
		$("#D").show();
		$("#E").show();
		$("#F").show();	
		$("#display #up").text("");
		$("#display #down").text(temp);
		print();
		if(temp!="" && temp1> 0)
		{
			$("#display #up").append(temp);
		}
		base =16;
		}
	});
	
	//dot
	$(".dot").click(function(){
	if(temp1!=3 && temp1!=2)
	{
		if(temp1==-1){
			clean();
			$("#display #down").text(0).append(".");
		}
		else if( $("#display #down").text().indexOf(".") > 0 ){
		}
		else if( $("#display #down").text() == ""){
			$("#display #down").text(0).append(".");
		}
		else{
			$("#display #down").append(".");
		}
	 
	 print();
	 temp1=0;
	 }
	});
	
	//clear
	$(".clear").click(function(){
		result =0;
		temp = 0;
		temp1 = 0;
		bracket=0;
		sqrt=0;
		$("#display #up").text("");
		$("#display #down").text("");
		clean();

	});
	
	//plus and minus
	$(".pm").click(function(){
	if(temp1==-1 || temp1==0 || temp1==3 || temp1==4)
	{	
		temp = $("#display #down").text();
		var test=output[output.length-1];
		if(temp1==0 && (temp=="0"||temp=="0.") && (test=="%4"||test=="%5"||test=="%6")){
			alert("Divide by zero!")
		}
		else{	
			if(temp1==-1)
			{
				clean();
			}
			if(temp!="")
			{
				output.push(temp);
			}
			output.push(this.value);

			$("#display #up").text("");
			$("#display #down").text("");
		
			print();		
			temp1 = 1;
		}
	}	
	});

	//times and divide
	$(".td").click(function(){
	if(temp1==-1 || temp1==0 || temp1==3 || temp1==4)
	{	
		temp = $("#display #down").text();
		var test=output[output.length-1];
		if(temp1==0 && temp=="0" && (test=="%4"||test=="%5"||test=="%6"))
		{
			alert("Divide by zero!")
		}
		else{	
			if(temp1==-1)
			{
				clean();
			}
			if(temp!="")
			{				
				output.push(temp);
			}
			output.push(this.value);

			$("#display #up").text("");
			$("#display #down").text("");
		
			print();		
			temp1 = 1;
		}
	}	
	});

	//left parenthesis
	$(".left").click(function(){
	if(temp1==1 || temp1==2 || (output.length==0 && $("#display #down").text()==""))
	{
		bracket++;
		output.push(this.value);
		$("#display #up").text("");
		print();
		temp1=1;
	}
	});
	
	//right parenthesis
	$(".right").click(function(){
	if(temp1==0 || temp1==3 || temp1==4)
	{
		if(bracket > 0)
		{
			temp = $("#display #down").text();
			var test=output[output.length-1];
			if(temp1==0 && (temp=="0"||temp=="0.") && (test=="%4"||test=="%5"||test=="%6")){
				alert("Divide by zero!")
			}
			else{	
				if(temp!="")
				{	
					output.push(temp);
				}
				output.push(this.value);

				bracket--;
				$("#display #up").text("");
				$("#display #down").text("");
				print();
		    
				temp1 = 3;
			}
		}
		else{
			alert("Parenthesis does not match!");
		}
	}
	});

	//power
	$(".power").click(function(){
	if(temp1==-1 || temp1==0 || temp1==3 || temp1==4)
	{	
		temp = $("#display #down").text();
		var test=output[output.length-1];
		if(temp1==0 && (temp=="0") && (test=="%4"||test=="%5"||test=="%6")){
			alert("Divide by zero!")
		}
		else{	
			if(temp1==-1)
			{
				clean();
			}
			if(temp!="")
			{	
				output.push(temp);
			}
			output.push(this.value);
			$("#display #up").text("");
			$("#display #down").text("");
		
			print();
			temp1 = 4;
		}
	}
	});
	
	//sqrt
	$(".sqrt").click(function(){
	if(temp1==1 || temp1==2 || (output.length==0 && $("#display #down").text()==""))
	{
		output.push(this.value);
		$("#display #up").text("");
		$("#display #down").text("");
		
		print();
		temp1 = 2;
	}
	});
	
	//back
	$(".back").click(function(){
		if(temp1!=-1)
		{
			var a=$("#display #down").text();
			if(a=="")
			{
				if(output.length>0)
				{
				var b=output[output.length-1];
				if(b>"0"){       
					var l=b.length;
					output.pop();
					b=b.substring(0,l-1);
					if(b.length>0){
						output.push(b);
					}
				}
				else{
					output.pop();
				}
				}
				var c=output[output.length-1];
				if(c=="%7"){
					temp1=2;
				}else if(c=="%8"){
					temp1=4;
				}else if(c=="#2"){
					temp1=3;
				}else if(c>"0"){
					temp1=0;
				}else{
					temp1=1;
				}
			}
			else{
				var l=a.length;
				a=a.substring(0,l-1);
			}
			$("#display #up").text("");
			$("#display #down").text("");
			print();
			$("#display #up").append(a);
			$("#display #down").append(a);
		}
	});
	
	//equal
	$(".equal").click(function(){
	if( temp1==0 || temp1==3 || temp1==4)
	{	
		if(bracket==0)
		{
			var num=[];
			var nopera=[];
			temp = $("#display #down").text();
			if(temp!="")
			{
				output.push(temp);
			}
			doo();
			while(operator.length>0)
			{
				var a=operator[operator.length-1];
				operation.push(a);
				operator.pop();
			}
			while(operation.length>0)
			{
				var a=operation[operation.length-1];
				nopera.push(a);
				operation.pop();
			}
			while(nopera.length>0)
			{
				while(nopera.length>0 && nopera[nopera.length-1]>="0")
				{
					var a =nopera[nopera.length-1];
					num.push(a);
					nopera.pop();
				}
				var b=nopera[nopera.length-1];
				nopera.pop();
				if(b=="%1")
				{
					var operant1=num[num.length-1];
					num.pop();
					var operant2=num[num.length-1];
					num.pop();
					var c= Number(operant1)+Number(operant2);
					num.push(c);
				}else if(b=="%2")
				{
					var operant1=num[num.length-1];
					num.pop();
					var operant2=num[num.length-1];
					num.pop();
					var c=Number(operant2)-Number(operant1);
					num.push(c);
				}else if(b=="%3")
				{
					var operant1=num[num.length-1];
					num.pop();
					var operant2=num[num.length-1];
					num.pop();
					var c=Number(operant1)*Number(operant2);
					num.push(c);
				}else if(b=="%4")
				{
					var operant1=num[num.length-1];
					num.pop();
					var operant2=num[num.length-1];
					num.pop();
					var c;
					if(parseInt(Number(operant2), 10) == Number(operant2) && parseInt(Number(operant1), 10) == Number(operant1)){
						c=Math.floor(Number(operant2)/Number(operant1));
						num.push(c);
					}
					else {
						alert("Div operation does on nonintegers!");
						clean();
						break;
					}
				}else if(b=="%5")
				{
					var operant1=num[num.length-1];
					num.pop();
					var operant2=num[num.length-1];
					num.pop();
					var c=Number(operant2)/Number(operant1);
					num.push(c);
				}else if(b=="%6")
				{
					var operant1=num[num.length-1];
					num.pop();
					var operant2=num[num.length-1];
					num.pop();
					var c;
					if(parseInt(Number(operant2), 10) == Number(operant2) && parseInt(Number(operant1), 10) == Number(operant1)){
						c= Number(operant2)% Number(operant1);
						num.push(c);
					}
					else {
						alert("Mod operation does on nonintegers!");
						clean();
						break;
					}
				}else if(b=="%7")
				{
					var operant1=num[num.length-1];
					num.pop();
					var c= Math.sqrt(Number(operant1));
					num.push(c);
				}else if(b=="%8")
				{
					var operant1=num[num.length-1];
					num.pop();
					var c= Number(operant1)*Number(operant1);
					num.push(c);
				}
		
			}
			result=num[0];
			$("#display #up").text("");
			$("#display #down").text(Number(result).toString(base));
		
			print();
			$("#display #up").append("=");
			temp1 = -1;
		}
		else{
			alert("Parethesis does not match!");
		}
	}
	});
	
	$(".number").click(function(){
		if(temp1 == -1)
		{
			temp=$("#display #down").text();
			clean();
			$("#display #up").text("");
			print();
			$("#display #down").text("").append(this.value);
			temp1=0;
		}
		else if(temp1!=3 && temp1!=4 )
		{
			if($("#display #down").text()=="0" && $("#display #down").text().indexOf(".") == 1)
			{
				$("#display #down").append(this.value);
			}else if($("#display #down").text()=="0")
			{
				$("#display #down").text("").append(this.value);
			}
			else{
				$("#display #down").append(this.value);
			}
			temp=$("#display #down").text();
		
			$("#display #up").text("");
			print();
			$("#display #up").append(temp);
			temp1=0;
		}
	});
	
	
	function print()
	{
		for(var i=0,l = output.length;i<l;i++){
			if(output[i]=="%1"){
				$("#display #up").append("+");
			}else if(output[i]=="%2"){
				$("#display #up").append("-");
			}else if(output[i]=="%3"){
				$("#display #up").html(function(i,origText){
					return origText +"&times";
				});
			}else if(output[i]=="%4"){
				$("#display #up").append("/");
			}else if(output[i]=="%5"){
				$("#display #up").html(function(i,origText){
					return origText +"&divide";
				});
			}else if(output[i]=="%6"){
				$("#display #up").append("%");
			}else if(output[i]=="%7"){
				$("#display #up").html(function(i,origText){
					return origText +"&#8730";
				});
			}else if(output[i]=="%8"){
				$("#display #up").append("^2");
			}else if(output[i]=="#1"){
				$("#display #up").append("(");
			}else if(output[i]=="#2"){
				$("#display #up").append(")");
			}else{		
				$("#display #up").append(output[i]);
			}
		}
	}
	
	function clean()
	{
		for(var i=0,l=operation.length;i<l;i++){
			operation.pop();
		}
		for(var i=0,l=operator.length;i<l;i++){
			operator.pop();
		}
		for(var i=0,l=output.length;i<l;i++){
			output.pop();
		}
	}
	
	function doo()
	{
		for(var i=0,l=output.length;i<l;i++)
		{
			if(output[i]=="%1" || output[i]=="%2")
			{
				while(sqrt>0)
				{
					operation.push("%7");
					sqrt--;
				}
				while (operator.length>0 && operator[operator.length-1] >"%2")
				{
					var a=operator[operator.length-1];
					operation.push(a);
					operator.pop();
				}
				operator.push(output[i]);
			}else if(output[i]=="%3" || output[i]=="%4" || output[i]=="%5" || output[i]=="%6" )
			{
				while(sqrt>0)
				{
					operation.push("%7");
					sqrt--;
				}
				while (operator.length>0 && operator[operator.length-1] >"%2" )
				{
					var a=operator[operator.length-1];
					operation.push(a);
					operator.pop();
				}
				operator.push(output[i]);
			}else if(output[i]=="%7")
			{
				sqrt++;
			}else if(output[i]=="%8")
			{
				while(sqrt>0)
				{
					operation.push("%7");
					sqrt--;
				}
				operator.push("%8");
			}else if(output[i]=="#1")
			{
				operator.push("#1");
			}else if(output[i]=="#2")
			{
				while(sqrt>0)
				{
					operation.push("%7");
					sqrt--;
				}			
				while (operator[operator.length-1] != "#1")
				{
					var a = operator[operator.length-1];
					operation.push(a);
					operator.pop();
				}
				operator.pop();
			}else
			{
				operation.push(transition(output[i],10));
			}
		}
		while(sqrt>0)
		{
			operation.push("%7");
			sqrt--;
		}
		return 0;
	}
	
	function transition(arg1, arg2)
	{
	var a=arg1;
	if(base!=10)
	{
		if(a.indexOf(".")>0){
			var Int=a.substring(0,a.indexOf("."));
			var dig=a.substring(a.indexOf(".")+1,a.length);
			var l=dig.length;
			Int=parseInt(Int,base);
			dig=parseInt(dig,base);
			for(var i=0;i<l;i++)
			{
				dig=Number(dig)/Number(base);
			}
			a=Number(Int)+Number(dig);
		}
		else{
			a=parseInt(a,base);
		}
	}
	return Number(a).toString(arg2);
	}
	
</script>

</html>
