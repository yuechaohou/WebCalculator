<!DOCTYPE html>
<html>
<head>
<link href="../07sundry/新建文件夹/bootstrap/css/bootstrap.css" rel="stylesheet">
<script type="text/javascript" src="jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
<link rel="stylesheet" type="text/css" href="style.css" />
<style>
    .gray{background: gray}
    .h300{height: 300px}
</style>
</head>
    
    
<body>
<div class="div1">
	<div class="div2 gray"></div>
	<div class="div5">
		<div id="display">
        <div class = "text" id="up"></div>
        <div class ="text" id="down"></div>
	</div>
      <div class = "buttons">
	   	<span id="left"><button class="digit button1" value="b"> b </button></span> 
		<span id="left">       <button class="number button1" id="1" value="1"> 1 </button>          </span>
		  <span id="left">     <button class="number button1" id="2" value="2"> 2 </button>            </span> 
		  <span id="left">     <button class="number button1" id="3" value="3"> 3 </button></span>
		 <span id="left">                <button class ="td button1" value="%3">times </button>                </span> 
				<span id="left">                  <button class="power button1" value="%6"> ^2</button>                </span>
				 </div>
         <div class="buttons"> <span id="left">
        <button class="digit button1" value="decimal"> d </button>
        </span> <span id="left">
          <button class="number button1" id="4" value="4"> 4 </button>
          </span> <span id="left">
            <button class="number button1" id="5" value="5"> 5 </button>
            </span> <span id="left">
              <button class="number button1" id="6" value="6"> 6 </button>
              </span> <span id="left">
                <button class="td button1" value="%4"> divide</button>
                </span> <span id="left">
                  <button class="sqrt button1" value="%5"> &#8730 </button>
                  </span> <span id="left">
                    <button class="back button1" > &#8592 </button>
                  </span> </div>
        <div class="buttons"> <span id="left">
        <button class="button1 digit" value="octual"> o </button>
        </span> <span id="left">
          <button class="number button1" id="7" value="7"> 7 </button>
          </span> <span id="left">
            <button class="number button1" id="8" value="8"> 8 </button>
            </span> <span id="left">
              <button class="number button1" id="9" value="9"> 9 </button>
              </span><span id="left">
                <button class="pm button1" value="%1"> + </button></span>
                 <span class="left">
                  <button class="left button1" value="#1"> (</button>
                </span> </div>
        <div class="buttons"> <span id="left">
        <button class="digit button1" value="hexa"> h </button>
        </span> <span id="left">
          <button class="number button1" id="0" value="0"> 0 </button>
          </span> <span id="left">
            <button class="clear button1"> c </button>
            </span> <span id="left">
              <button class="pm button1" value="%2"> - </button>
              </span> <span id="left">
                <button class= "equal button1" value="="> = </button>
                </span> <span id="left">
                  <button class="right button1" value="#2"> )</button>
                  </span> <span id="left">
                    <button class="dot button1" value="."> . </button>
                  </span> </div>
		<p>
        	<button class="number" id="A" value="a"> A </button><button class="number" id="B" value="b"> B </button><button class="number" id="C" value="c"> C </button><button class="number" id="D" value="d"> D </button><button class="number" id="E" value="e"> E </button><button class="number" id="F" value="f"> F </button>
        </p>
</div>
</body>


<script>
	var result =0;
	var temp =0;
	var temp1 =0;
	var bracket=0;
	var sqrt=0;
	var output=[];
	var operator=[];
	var operation=[];
	var base = 10;
	$(function(){
		$("#A").hide();
		$("#B").hide();
		$("#C").hide();
		$("#D").hide();
		$("#E").hide();
		$("#F").hide();		
	});
	$(".digit").click(function(){
		if(this.value=="binary"){
		temp = $("#display #down").text();
		for(var i=0,l=output.length;i<l;i++)
		{
			if(output[i]>"0")
			{
			output[i]=transition(output[i],2);
			}
		}
		if(temp!=""&&temp1!=-1)
		{
		temp=transition(temp,2);
		output.push(temp);
		}
		$("#2").hide();
		$("#3").hide();
		$("#4").hide();
		$("#5").hide();
		$("#6").hide();
		$("#7").hide();	
		$("#8").hide();
		$("#9").hide();
		$("#A").hide();
		$("#B").hide();
		$("#C").hide();
		$("#D").hide();
		$("#E").hide();
		$("#F").hide();	
		$("#display #up").text("");
		$("#display #down").text("");
		print();
		base =2;
		}
		else if(this.value=="octual"){
		temp = $("#display #down").text();
		for(var i=0,l=output.length;i<l;i++)
		{
			if(output[i]>"0")
			{
			output[i]=transition(output[i],8);
			}
		}
		if(temp!=""&&temp1!=-1)
		{
		temp=transition(temp,8);
		output.push(temp);
		}
		$("#2").show();
		$("#3").show();
		$("#4").show();
		$("#5").show();
		$("#6").show();
		$("#7").show();	
		$("#8").hide();
		$("#9").hide();
		$("#A").hide();
		$("#B").hide();
		$("#C").hide();
		$("#D").hide();
		$("#E").hide();
		$("#F").hide();	
		$("#display #up").text("");
		$("#display #down").text("");
		print();
		base =8;
		}
		else if(this.value=="decimal"){
		temp = $("#display #down").text();
		for(var i=0,l=output.length;i<l;i++)
		{
			if(output[i]>"0")
			{
			output[i]=transition(output[i],10);
			}
		}
		if(temp!=""&&temp1!=-1)
		{
		temp=transition(temp,10);
		output.push(temp);
		}
		$("#2").show();
		$("#3").show();
		$("#4").show();
		$("#5").show();
		$("#6").show();
		$("#7").show();	
		$("#8").show();
		$("#9").show();
		$("#A").hide();
		$("#B").hide();
		$("#C").hide();
		$("#D").hide();
		$("#E").hide();
		$("#F").hide();	
		$("#display #up").text("");
		$("#display #down").text("");
		print();
		base =10;
		}
		else if(this.value="hexa"){
		temp = $("#display #down").text();
		for(var i=0,l=output.length;i<l;i++)
		{
			if(output[i]>"0")
			{
			output[i]=transition(output[i],16);
			}
		}
		if(temp!=""&&temp1!=-1)
		{
		temp=transition(temp,16);
		output.push(temp);
		}
		$("#2").show();
		$("#3").show();
		$("#4").show();
		$("#5").show();
		$("#6").show();
		$("#7").show();	
		$("#8").show();
		$("#9").show();
		$("#A").show();
		$("#B").show();
		$("#C").show();
		$("#D").show();
		$("#E").show();
		$("#F").show();	
		$("#display #up").text("");
		$("#display #down").text("");
		print();
		base =16;
		}
	});
	$(".dot").click(function(){
	if(temp1!=3 && temp1!=2)
	{
	 if( $("#display #down").text().indexOf(".") > 0 ){
	 }
	 else if( $("#display #down").text() == ""){
         $("#display #down").text("0").append(".");
     }
	 else{
		 $("#display #down").append(".");
	 }
	 temp1=0;
	 }
	});
	
	//clear
	$(".clear").click(function(){
		result =0;
		temp = 0;
		$("#display #up").text("");
		$("#display #down").text(0);
		for(var i=0,l=operation.length;i<l;i++){
			operation.pop();
		}
		for(var i=0,l=operator.length;i<l;i++){
			operator.pop();
		}
		for(var i=0,l=output.length;i<l;i++){
			output.pop();
		}

	});
	
	//plus and minus
	$(".pm").click(function(){
	if(temp1==0 || temp1==3 || temp1==4)
	{	
		temp = $("#display #down").text();
		if(temp!="")
		{	
			output.push(temp);
		}
		output.push(this.value);

		$("#display #up").text("");
		$("#display #down").text("");
		
		print();
		
		temp1 = 1;
	}	
	});

	//times and divide
	$(".td").click(function(){
	if(temp1==0 || temp1==3 || temp1==4)
	{	
		temp = $("#display #down").text();
		if(temp!="")
		{				
			output.push(temp);
		}
		output.push(this.value);

		$("#display #up").text("");
		$("#display #down").text("");
		
		print();
		
		temp1 = 1;
	}	
	});

	$(".left").click(function(){
	if(temp1==1 || temp1==2 || (output.length==0 && $("#display #down").text()=="0"))
	{
		bracket++;
		output.push(this.value);
		$("#display #up").text("");
		print();
		temp1=1;
	}
	});
	
	$(".right").click(function(){
	if(temp1==0 || temp1==3 || temp1==4)
	{
		if(bracket > 0)
		{
			temp = $("#display #down").text();
			if(temp!="")
			{	
			output.push(temp);
			}
			output.push(this.value);

			bracket--;
			$("#display #up").text("");
			$("#display #down").text("");
			print();
		    
			temp1 = 3;
		}
	}
	});

	//power
	$(".power").click(function(){
	if(temp1==0 || temp1==3 || temp1==4)
	{	
		temp = $("#display #down").text();
		if(temp!="")
		{	
		output.push(temp);
		}
		output.push(this.value);
		$("#display #up").text("");
		$("#display #down").text("");
		
		print();
		
		temp1 = 4;
	}
	});
	
	//sqrt
	$(".sqrt").click(function(){
	if(temp1==1 || temp1==2 || (output.length==0 && $("#display #down").text()=="0"))
	{
		output.push(this.value);
		$("#display #up").text("");
		$("#display #down").text("");
		
		print();
		
		temp1 = 2;
	}
	});
	
	//back
	$(".back").click(function(){
		if(temp1!=-1)
		{
			var a=$("#display #down").text();
			if(a=="")
			{
				if(output.length>0)
				{
				var b=output[output.length-1];
				if(b>"0"){
					var l=b.length;
					output.pop();
					b=b.substring(0,l-1);
					if(b.length>0){
						output.push(b);
					}
				}
				else{
					output.pop();
				}
				}
				var c=output[output.length-1];
				if(c=="%5"){
					temp1=2;
				}else if(c=="%6"){
					temp1=4;
				}else if(c=="#2"){
					temp1=3;
				}else if(c>"0"){
					temp1=0;
				}else{
					temp1=1;
				}
			}
			else{
				var l=a.length;
				a=a.substring(0,l-1);
			}
			$("#display #up").text("");
			$("#display #down").text("");
			print();
			$("#display #up").append(a);
			$("#display #down").append(a);
		}
	});
	
	//equal
	$(".equal").click(function(){
	if(temp1==-1 || temp1==0 || temp1==3 || temp1==4)
	{	
		if(bracket==0)
		{
		var num=[];
		var nopera=[];
		temp = $("#display #down").text();
		if(temp!="")
		{
		output.push(temp);
		}
		doo();
		while(operator.length>0)
		{
			var a=operator[operator.length-1];
			operation.push(a);
			operator.pop();
		}
		while(operation.length>0)
		{
			var a=operation[operation.length-1];
			nopera.push(a);
			operation.pop();
		}
		while(nopera.length>0)
		{
			while(nopera.length>0 && nopera[nopera.length-1]>="0")
			{
				var a =nopera[nopera.length-1];
				num.push(a);
				nopera.pop();
			}
			var b=nopera[nopera.length-1];
			nopera.pop();
			if(b=="%1")
			{
				var operant1=num[num.length-1];
				num.pop();
				var operant2=num[num.length-1];
				num.pop();
				var c= Number(operant1)+Number(operant2);
				num.push(c);
			}else if(b=="%2")
			{
				var operant1=num[num.length-1];
				num.pop();
				var operant2=num[num.length-1];
				num.pop();
				var c=Number(operant2)-Number(operant1);
				num.push(c);
			}else if(b=="%3")
			{
				var operant1=num[num.length-1];
				num.pop();
				var operant2=num[num.length-1];
				num.pop();
				var c=Number(operant1)*Number(operant2);
				num.push(c);
			}else if(b=="%4")
			{
				var operant1=num[num.length-1];
				num.pop();
				var operant2=num[num.length-1];
				num.pop();
				var c=Number(operant2)/Number(operant1);
				num.push(c);
			}else if(b=="%5")
			{
				var operant1=num[num.length-1];
				num.pop();
				var c= Math.sqrt(Number(operant1));
				num.push(c);
			}else if(b=="%6")
			{
				var operant1=num[num.length-1];
				num.pop();
				var c= Number(operant1)*Number(operant1);
				num.push(c);
			}
		
		}
		result=num[0];
		$("#display #up").text("");
		$("#display #down").text(Number(result).toString(base));
		
		print();
		$("#display #up").append("=");		
		temp1 = -1;
		}
	}
	});
	
	$(".number").click(function(){
		if(temp1!=3 && temp1!=4)
		{
		if($("#display #down").text()=="0" && $("#display #down").text().indexOf(".") == 0)
		{
			$("#display #down").append(this.value);
		}else if($("#display #down").text()=="0")
		{
			$("#display #down").text("").append(this.value);
		}
		else{
			$("#display #down").append(this.value);
		}
		temp=$("#display #down").text();
		
		$("#display #up").text("");
		print();
		$("#display #up").append(temp);
		temp1=0;
		}

	});
	
	
	function print()
	{
		for(var i=0,l = output.length;i<l;i++){
		if(output[i]=="%1"){
		$("#display #up").append("+");
		}else if(output[i]=="%2"){
		$("#display #up").append("-");
		}else if(output[i]=="%3"){
		$("#display #up").html(function(i,origText){
			return origText +"&times";
		});
		}else if(output[i]=="%4"){
		$("#display #up").html(function(i,origText){
			return origText +"&divide";
		});
		}else if(output[i]=="%5"){
		$("#display #up").html(function(i,origText){
			return origText +"&#8730";
		});
		}else if(output[i]=="%6"){
		$("#display #up").append("^2");
		}else if(output[i]=="#1"){
		$("#display #up").append("(");
		}else if(output[i]=="#2"){
		$("#display #up").append(")");
		}else if(output[i]=="="){
		$("#display #up").append("=");
		}else{		
		$("#display #up").append(output[i]);
		}
		}
	}
	
	
	function doo()
	{
	for(var i=0,l=output.length;i<l;i++)
	{
		if(output[i]=="%1" || output[i]=="%2")
		{
			while(sqrt>0)
			{
			operation.push("%5");
			sqrt--;
			}
			while (operator.length>0 && operator[operator.length-1] >"%2")
			{
				var a=operator[operator.length-1];
				operation.push(a);
				operator.pop();
			}
			operator.push(output[i]);
		}else if(output[i]=="%3" || output[i]=="%4")
		{
			while(sqrt>0)
			{
			operation.push("%5");
			sqrt--;
			}
			while (operator.length>0 && operator[operator.length-1] >"%4")
			{
				var a=operator[operator.length-1];
				operation.push(a);
				operator.pop();
			}
			operator.push(output[i]);
		}else if(output[i]=="%5")
		{
			sqrt++;
		}else if(output[i]=="%6")
		{
			while(sqrt>0)
			{
			operation.push("%5");
			sqrt--;
			}
			operator.push("%6");
		}else if(output[i]=="#1")
		{
			operator.push("#1");
		}else if(output[i]=="#2")
		{
			while(sqrt>0)
			{
			operation.push("%5");
			sqrt--;
			}			
			while (operator[operator.length-1] != "#1")
			{
				var a = operator[operator.length-1];
				operation.push(a);
				operator.pop();
			}
			operator.pop();
		}else
		{
		operation.push(transition(output[i],10));
		}
	}
	while(sqrt>0)
		{
			operation.push("%5");
			sqrt--;
		}
	return 0;
	}
	
	function transition(arg1, arg2)
	{
	var a=arg1;
	if(base!=10)
	{
		if(a.indexOf(".")>0){
		var Int=a.substring(0,a.indexOf("."));
		var dig=a.substring(a.indexOf(".")+1,a.length);
		var l=dig.length;
		Int=parseInt(Int,base);
		dig=parseInt(dig,base);
		for(var i=0;i<l;i++)
		{
		dig=Number(dig)/Number(base);
		}
		a=Number(Int)+Number(dig);
		}
		else{
		a=parseInt(a,base);
		}
	}
	return Number(a).toString(arg2);
	}
	
</script>

</html>
